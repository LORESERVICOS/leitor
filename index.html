
     <!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Leitor de Código de Barras</title>
  <script src="https://unpkg.com/html5-qrcode"></script>
</head>
<body>
  <h2>Leitor de Código de Barras</h2>
  <div id="reader" style="width:300px"></div>
  <p><b>Código Lido:</b> <span id="codigo"></span></p>

  <label>Quantidade:</label>
  <input type="number" id="quantidade" value="1"><br><br>

  <button onclick="enviarDados()">Enviar</button>

  <script>
    let codigoLido = "";

    function onScanSuccess(decodedText, decodedResult) {
      codigoLido = decodedText;
      document.getElementById("codigo").innerText = decodedText;
    }

    function onScanFailure(error) {
      // aqui só ignora falhas
    }

    let html5QrcodeScanner = new Html5QrcodeScanner(
      "reader", 
      { fps: 10, qrbox: { width: 250, height: 150 } }, 
      false
    );
    html5QrcodeScanner.render(onScanSuccess, onScanFailure);

    function enviarDados() {
      if (!codigoLido) {
        alert("Escaneie um código de barras primeiro!");
        return;
      }
      const quantidade = document.getElementById("quantidade").value;
      const url = "https://script.google.com/macros/s/AKfycbz_XqyJWgmNIAoUm37brJ-EJUt4QxNtFNmLi2GsgpM5jimiGPRZuaCS3SQbhXe9PyjZDg/exec"; // substitua pelo link do Google App Script
      fetch(url, {
        method: "POST",
        body: JSON.stringify({ codigo: codigoLido, quantidade: quantidade })
      })
      .then(r => r.text())
      .then(r => {
        alert("Dados enviados com sucesso!");
        location.reload(); // reinicia para próxima leitura
      });
    }
  </script>
</body>
</html>
